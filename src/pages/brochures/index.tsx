import type { NextPage } from "next";
import Head from "next/head";
import Image from "next/image";
import LayoutDefault from "../../layout/Default";
import styles from "../../../styles/Brochures.module.scss";
import Hero from "../../components/Brochures/Hero";

const Brochures: NextPage = ({ catalogue }: any) => {
  console.log(catalogue);
  
  return (
    <>
      <LayoutDefault>
        <Hero />
        <div className={styles.container}>
          <Head>
            <title>Stratoz</title>
            <meta name="description" content="Generated by create next app" />
            <link rel="icon" href="/favicon.ico" />
          </Head>

          <main className={styles.main}>
            <div className={styles.title_desc}>
              <div className={"container " + styles.mb50}>
                <h2 className={styles.h2_title}>
                  <span>Brochures</span> 
                </h2>
              </div>
            </div>
            <div className={styles.products}>
              <div className="container mb-5">
                <div className="row">
                  {catalogue.map((data: any, index: number) => (
                    <div key={index} className="col-md-4">
                      <a href={`/brochures/${data.slug}`}>
                        <div className={styles.col4img + " " + styles.overlay}>
                          <Image
                            src={
                              data?.image
                                ? `${process.env.NEXT_PUBLIC_API_BASE_URL}${data?.image?.url}`
                                : "/products/5.png"
                            }
                            alt={data.title}
                            height="100%"
                            width="100%"
                            layout="responsive"
                          />
                        </div>
                        <div className={styles.text + " " + styles.shortText + " mt-3"}>
                          <h6 className={"text-center"}>{data.title}</h6>
                          <p>{data.content}</p>
                        </div>
                      </a>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          </main>
        </div>
      </LayoutDefault>
    </>
  );
};

export async function getServerSideProps() {
  // Fetch all catalogues form API
  const catalogues = await fetch(`${process.env.API_BASE_URL}/catalogues`);

  const catalogue = await catalogues.json();

  // Pass data to the page via props
  return { props: { catalogue } };
}

export default Brochures;
